(function(t){function e(e){for(var o,i,r=e[0],c=e[1],u=e[2],d=0,f=[];d<r.length;d++)i=r[d],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&f.push(s[i][0]),s[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);l&&l(e);while(f.length)f.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(o=!1)}o&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},s={app:0},a=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/mytasks/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("85ec"),s=n.n(o);s.a},1668:function(t,e,n){"use strict";var o=n("a627"),s=n.n(o);s.a},3374:function(t,e,n){"use strict";var o=n("7b56"),s=n.n(o);s.a},"4e40":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Navbar",{attrs:{connected:t.connected,isAdmin:t.isAdmin}}),n("router-view"),n("Footer")],1)},a=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",[n("div",{staticClass:"logo"},[n("router-link",{attrs:{to:{name:"Home"}}},[n("h4",[n("span",{staticClass:"title-first"},[t._v("My")]),n("span",[t._v("Tasks")])])])],1),t.connected?n("ul",{staticClass:"nav-links"},[n("li",{on:{click:t.closeMenu}},[n("router-link",{attrs:{to:{name:"Dashboard"}}},[t._v("Dashboard")])],1),t.isAdmin?n("li",{on:{click:t.closeMenu}},[n("router-link",{attrs:{to:{name:"Administration"}}},[t._v("Admin")])],1):t._e(),n("li",{on:{click:t.logout}},[n("a",[t._v("Disconnect")])])]):n("ul",{staticClass:"nav-links"},[n("li",{on:{click:t.closeMenu}},[n("router-link",{attrs:{to:{name:"Home"}}},[t._v("Home")])],1),n("li",{on:{click:t.closeMenu}},[n("router-link",{attrs:{to:{name:"Register"}}},[t._v("Register")])],1),n("li",{on:{click:t.closeMenu}},[n("router-link",{attrs:{to:{name:"Login"}}},[t._v("Login")])],1)]),n("div",{staticClass:"burger",on:{click:t.navSlide}},[n("div",{staticClass:"line1"}),n("div",{staticClass:"line2"}),n("div",{staticClass:"line3"})])])},r=[],c=(n("4160"),n("159b"),{name:"Navbar",props:{connected:{type:Boolean,required:!0},isAdmin:{type:Boolean,required:!0}},methods:{navSlide:function(){document.querySelector(".nav-links").classList.toggle("nav-active"),document.querySelectorAll(".nav-links li").forEach((function(t,e){t.style.animation?t.style.animation="":t.style.animation="navLinkFade 0.5s ease forwards ".concat(e/7+.3,"s")})),document.querySelector(".burger").classList.toggle("toggle")},closeMenu:function(){document.querySelector(".nav-active")&&this.navSlide()},logout:function(){localStorage.removeItem("token"),this.$router.push("/home"),this.closeMenu()}}}),u=c,l=(n("aa4e"),n("2877")),d=Object(l["a"])(u,i,r,!1,null,"e8e76fb0",null),f=d.exports,m=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},p=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("footer",[n("p",[t._v(" Made with ❤️ by "),n("a",{attrs:{href:"https://maeldonn.github.io/",target:"_blank"}},[t._v("maeldonn")])])])}],h={name:"Footer"},v=h,g=(n("1668"),Object(l["a"])(v,m,p,!1,null,"7fc98d3c",null)),_=g.exports,b=n("bc3a"),k=n.n(b),y={name:"App",components:{Navbar:f,Footer:_},data:function(){return{connected:!1,isAdmin:!1}},watch:{$route:{handler:function(){this.isConnected()}}},mounted:function(){this.isConnected()},methods:{isConnected:function(){var t=this;localStorage.token?k.a.get("https://mytasks0.herokuapp.com/",{headers:{Authorization:"Bearer ".concat(localStorage.token)}}).then((function(e){"admin"===e.data.user.role?t.isAdmin=!0:t.isAdmin=!1,t.connected=!0})).catch((function(){t.connected=!1,t.isAdmin=!1,localStorage.removeItem("token")})):(this.connected=!1,this.isAdmin=!1)}}},w=y,C=(n("034f"),Object(l["a"])(w,s,a,!1,null,null,null)),T=C.exports,L=n("8c4f"),$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"home"},[n("Title",{attrs:{content:"Home"}}),n("div",{staticClass:"panel"},[t._m(0),n("hr"),n("div",{staticClass:"buttons"},[n("router-link",{attrs:{to:{name:"Register"}}},[n("button",[t._v("REGISTER")])]),n("router-link",{attrs:{to:{name:"Login"}}},[n("button",[t._v("LOGIN")])])],1)])],1)},A=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"description"},[n("h2",[t._v(" Welcome to "),n("span",{staticClass:"title-first"},[t._v("My")]),n("span",[t._v("Tasks")])]),n("h3",[t._v("A new place to manage your daily tasks... ✅")])])}],S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",[t._v(t._s(t.content))])])},E=[],x={name:"Title",props:{content:{type:String,required:!0}}},j=x,P=(n("c628"),Object(l["a"])(j,S,E,!1,null,"49518470",null)),M=P.exports,O={name:"Home",components:{Title:M}},q=O,z=(n("c4d9"),Object(l["a"])(q,$,A,!1,null,"79c51058",null)),R=z.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Authentification",{attrs:{type:"Register"}})},F=[],D=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"authentification"},[o("Title",{attrs:{content:t.type}}),t.isLoading?o("div",{staticClass:"spinner"},[o("img",{attrs:{src:n("5c3d")}})]):t._e(),o("div",{staticClass:"error",class:t.errorMessage?"active":null},[t.errorMessage?o("p",[t._v(t._s(t.errorMessage))]):t._e()]),t.isLoading?t._e():o("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[o("section",{staticClass:"form-section"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.user.email,expression:"user.email"}],ref:"email",attrs:{type:"text",id:"email",autocomplete:"off",required:""},domProps:{value:t.user.email},on:{input:function(e){e.target.composing||t.$set(t.user,"email",e.target.value)}}}),t._m(0)]),o("section",{staticClass:"form-section"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],attrs:{type:"password",id:"password",autocomplete:"off",required:""},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}}),t._m(1)]),"Register"===t.type?o("section",{staticClass:"form-section"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.user.confirmPassword,expression:"user.confirmPassword"}],attrs:{type:"password",id:"confirm-password",autocomplete:"off",required:""},domProps:{value:t.user.confirmPassword},on:{input:function(e){e.target.composing||t.$set(t.user,"confirmPassword",e.target.value)}}}),t._m(2)]):t._e(),o("button",{attrs:{type:"submit"}},[t._v(t._s(t.type))])])],1)},B=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"label",attrs:{for:"email"}},[n("span",{staticClass:"content"},[t._v("Email")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"label",attrs:{for:"password"}},[n("span",{staticClass:"content"},[t._v("Password")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"label",attrs:{for:"confirm-password"}},[n("span",{staticClass:"content"},[t._v("Password confirmation")])])}],N=(n("caad"),n("2532"),n("498a"),n("d370")),H=n.n(N),I=H.a.object({email:H.a.string().email({tlds:{allow:!1}}).required(),password:H.a.string().trim().min(8).required(),confirmPassword:H.a.ref("password")}),G=H.a.object({email:H.a.string().email({tlds:{allow:!1}}).required(),password:H.a.string().trim().min(8).required()}),J={name:"Authentification",components:{Title:M},props:{type:{type:String,required:!0}},data:function(){return{isLoading:!1,errorMessage:"",user:{email:"",password:"",confirmPassword:""},submit:function(){}}},watch:{user:{handler:function(){this.errorMessage=""},deep:!0}},mounted:function(){this.submit="Register"===this.type?this.register:this.login},methods:{register:function(){var t=this;this.validUser()&&(this.isLoading=!0,k.a.post("".concat("https://mytasks0.herokuapp.com/","auth/register"),{email:this.user.email,password:this.user.password},{headers:{"content-type":"application/json"}}).then((function(e){localStorage.token=e.data.token,setTimeout((function(){t.isLoading=!1,t.$router.push("/dashboard")}),1e3)})).catch((function(e){429===e.response.status&&(t.isLoading=!1,t.$router.push("/")),setTimeout((function(){t.authentificationFailed(e.response.data.message)}),1e3)})))},login:function(){var t=this;this.validUser()&&(this.isLoading=!0,k.a.post("".concat("https://mytasks0.herokuapp.com/","auth/login"),{email:this.user.email,password:this.user.password},{headers:{"content-type":"application/json"}}).then((function(e){localStorage.token=e.data.token,setTimeout((function(){t.isLoading=!1,t.$router.push("/dashboard")}),1e3)})).catch((function(e){429===e.response.status&&(t.isLoading=!1,t.$router.push("/")),setTimeout((function(){t.authentificationFailed()}),1e3)})))},validUser:function(){var t=this;if(this.errorMessage="","Register"===this.type&&this.user.password!==this.user.confirmPassword)return this.authentificationFailed("Passwords must match."),!1;var e="Register"===this.type?I.validate(this.user):G.validate({email:this.user.email,password:this.user.password});return!(null===e||void 0===e?void 0:e.error)||("Register"===this.type?e.error.message.includes("email")?this.authentificationFailed("Email address must be unique and valid."):this.authentificationFailed("Your password must contain a minimum of 8 characters."):(this.isLoading=!0,setTimeout((function(){t.authentificationFailed()}),1e3)),!1)},authentificationFailed:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Connexion impossible.";this.user.password="","Register"===this.type&&(this.user.confirmPassword=""),setTimeout((function(){t.errorMessage=e}),10),this.isLoading=!1,o["a"].nextTick((function(){t.$refs.email.focus()}))}}},W=J,Y=(n("3374"),Object(l["a"])(W,D,B,!1,null,"556955ca",null)),K=Y.exports,Q={name:"Register",components:{Authentification:K}},V=Q,X=Object(l["a"])(V,U,F,!1,null,null,null),Z=X.exports,tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Authentification",{attrs:{type:"Login"}})},et=[],nt={name:"Login",components:{Authentification:K}},ot=nt,st=Object(l["a"])(ot,tt,et,!1,null,null,null),at=st.exports,it=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"dashboard"},[o("Title",{attrs:{content:"Dashboard"}}),t.isLoading?o("div",{staticClass:"spinner"},[o("img",{attrs:{src:n("5c3d")}})]):t._e(),t.isLoading?t._e():o("h1",[t._v("Logged in as "+t._s(t.user.email)+" 🔐")]),t.isLoading?t._e():o("form",{on:{submit:function(e){return e.preventDefault(),t.addTodo(e)}}},[o("section",{staticClass:"form-section"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newTodo,expression:"newTodo"}],attrs:{type:"text",id:"new-todo",autocomplete:"off",maxlength:"100",required:""},domProps:{value:t.newTodo},on:{input:function(e){e.target.composing||(t.newTodo=e.target.value)}}}),t._m(0)]),o("button",{attrs:{type:"submit"}},[t._v("ADD")])]),t.isLoading?t._e():o("ul",{attrs:{id:"scroll-list"}},t._l(t.todos,(function(e){return o("li",{key:e._id,on:{click:function(n){return t.deleteTodo(e._id)}}},[t._v(" "+t._s(e.title)+" ")])})),0)],1)},rt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"label",attrs:{for:"new-todo"}},[n("span",{staticClass:"content"},[t._v("New Todo")])])}],ct=(n("99af"),n("bc3a")),ut={name:"Dashboard",components:{Title:M},data:function(){return{isLoading:!0,user:null,todos:[],newTodo:""}},mounted:function(){var t=this;ct.get("https://mytasks0.herokuapp.com/",{headers:{Authorization:"Bearer ".concat(localStorage.token)}}).then((function(e){t.user=e.data.user,t.getTodos(),setTimeout((function(){t.isLoading=!1}),200)})).catch((function(e){t.unauthorized(e)}))},methods:{addTodo:function(){var t=this;ct.post("".concat("https://mytasks0.herokuapp.com/","api/v1/todos"),{title:this.newTodo},{headers:{"content-type":"application/json",Authorization:"Bearer ".concat(localStorage.token)}}).then((function(e){t.todos.push(e.data),t.newTodo=""})).catch((function(e){t.unauthorized(e)}))},getTodos:function(){var t=this;ct.get("".concat("https://mytasks0.herokuapp.com/","api/v1/todos"),{headers:{Authorization:"Bearer ".concat(localStorage.token)}}).then((function(e){t.todos=e.data})).catch((function(e){t.unauthorized(e)}))},deleteTodo:function(t){var e=this;ct.delete("".concat("https://mytasks0.herokuapp.com/","api/v1/todos/").concat(t),{headers:{Authorization:"Bearer ".concat(localStorage.token)}}).then((function(t){e.todos=t.data})).catch((function(t){e.unauthorized(t)}))},unauthorized:function(t){401===t.response.status&&(localStorage.removeItem("token"),this.$router.push("/login"))}}},lt=ut,dt=(n("73a1"),Object(l["a"])(lt,it,rt,!1,null,"0ce97be4",null)),ft=dt.exports,mt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",{staticClass:"administration"},[o("Title",{attrs:{content:"Admin"}}),t.isLoading?o("div",{staticClass:"spinner"},[o("img",{attrs:{src:n("5c3d")}})]):t._e(),t.isLoading?t._e():o("form",[o("section",{staticClass:"form-section"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.filter,expression:"filter"}],attrs:{type:"text",id:"user-filter",autocomplete:"off",required:""},domProps:{value:t.filter},on:{input:function(e){e.target.composing||(t.filter=e.target.value)}}}),t._m(0)])]),t.isLoading?t._e():o("ul",{attrs:{id:"scroll-list"}},t._l(t.filteredUsers,(function(e){return o("li",{key:e._id,on:{click:function(n){return t.desactivateUser(e)}}},[o("p",{class:e.active?null:"unactive"},[t._v(t._s(e.email))]),e.active?t._e():o("p",{staticClass:"unactive"},[t._v("(Desactivated)")])])})),0)],1)},pt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"label",attrs:{for:"user-filter"}},[n("span",{staticClass:"content"},[t._v("Filter")])])}],ht=(n("4de4"),n("bc3a")),vt={name:"Administration",components:{Title:M},data:function(){return{isLoading:!0,users:[],filteredUsers:[],filter:""}},watch:{filter:{handler:function(){this.filterUsers(this.filter)}}},mounted:function(){this.getUsers()},methods:{getUsers:function(){var t=this;ht.get("https://mytasks0.herokuapp.com/",{headers:{Authorization:"Bearer ".concat(localStorage.token)}}).then((function(e){"admin"!==e.data.user.role?t.$router.push("/dashboard"):ht.get("".concat("https://mytasks0.herokuapp.com/","api/v1/users"),{headers:{Authorization:"Bearer ".concat(localStorage.token)}}).then((function(e){t.users=e.data.filter((function(t){return"user"===t.role})),t.filterUsers(t.filter),setTimeout((function(){t.isLoading=!1}),200)})).catch((function(){t.$router.push("/dashboard")}))})).catch((function(e){t.unauthorized(e)}))},desactivateUser:function(t){var e=this;ht.patch("".concat("https://mytasks0.herokuapp.com/","api/v1/users/").concat(t._id),{active:!t.active},{headers:{"content-type":"application/json",Authorization:"Bearer ".concat(localStorage.token)}}).then((function(){e.getUsers()})).catch((function(t){e.unauthorized(t)}))},filterUsers:function(t){this.filteredUsers=this.users.filter((function(e){return e.email.includes(t)}))},unauthorized:function(t){401===t.response.status&&this.$router.push("/dashboard")}}},gt=vt,_t=(n("b435"),Object(l["a"])(gt,mt,pt,!1,null,"05aacc0e",null)),bt=_t.exports;function kt(t,e,n){localStorage.token?n("/dashboard"):n()}function yt(t,e,n){localStorage.token?n():n("/login")}o["a"].use(L["a"]);var wt=[{path:"/",name:"Home",component:R,beforeEnter:kt},{path:"/register",name:"Register",component:Z,beforeEnter:kt},{path:"/login",name:"Login",component:at,beforeEnter:kt},{path:"/dashboard",name:"Dashboard",component:ft,beforeEnter:yt},{path:"/administration",name:"Administration",component:bt,beforeEnter:yt},{path:"*",name:"404",component:R,beforeEnter:kt}],Ct=new L["a"]({mode:"history",base:"/mytasks/",routes:wt});Ct.beforeEach((function(t,e,n){document.title="MyTasks",n()}));var Tt=Ct;o["a"].config.productionTip=!1,new o["a"]({router:Tt,render:function(t){return t(T)}}).$mount("#app")},"5c3d":function(t,e,n){t.exports=n.p+"img/spinner.821014c1.svg"},"73a1":function(t,e,n){"use strict";var o=n("781f"),s=n.n(o);s.a},"781f":function(t,e,n){},"7b56":function(t,e,n){},"85ec":function(t,e,n){},a2d1:function(t,e,n){},a627:function(t,e,n){},aa4e:function(t,e,n){"use strict";var o=n("a2d1"),s=n.n(o);s.a},b2d8:function(t,e,n){},b435:function(t,e,n){"use strict";var o=n("b2d8"),s=n.n(o);s.a},c4d9:function(t,e,n){"use strict";var o=n("fd25"),s=n.n(o);s.a},c628:function(t,e,n){"use strict";var o=n("4e40"),s=n.n(o);s.a},fd25:function(t,e,n){}});
//# sourceMappingURL=app.4b7e9ccf.js.map